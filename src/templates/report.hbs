<html>
  <head>
    <title>Git Commit Report</title>
    <script src='https://cdn.jsdelivr.net/npm/chart.js'></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #e0e0e0;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }
      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
      }
      .stat-number {
        font-size: 2em;
        font-weight: bold;
      }
      .chart-section {
        margin: 30px 0;
        text-align: center;
      }
      .chart-container {
        position: relative;
        height: 400px;
        width: 100%;
        max-width: 600px;
        margin: 0 auto;
      }
      .categories-table {
        margin-top: 20px;
        width: 100%;
        border-collapse: collapse;
      }
      .categories-table th,
      .categories-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      .categories-table th {
        background-color: #f8f9fa;
        font-weight: bold;
      }
      .category-color {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 10px;
      }
      .commit {
        margin: 15px 0;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #fafafa;
      }
      .commit-message {
        font-weight: bold;
        margin-bottom: 8px;
      }
      .commit-meta {
        color: #666;
        font-size: 0.9em;
      }
      .category-badge {
        display: inline-block;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 0.8em;
        color: white;
        margin-left: 10px;
      }
      .leaderboard-section {
        margin: 30px 0;
      }
      .leaderboard-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      .leaderboard-table th,
      .leaderboard-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      .leaderboard-table th {
        background-color: #f8f9fa;
        font-weight: bold;
      }
      .leaderboard-table tbody tr:hover {
        background-color: #f5f5f5;
      }
      .leaderboard-rank {
        font-weight: bold;
        text-align: center;
        width: 80px;
      }
      .leaderboard-badge {
        font-size: 1.2em;
        margin-right: 5px;
      }
      .leaderboard-contributor {
        max-width: 250px;
      }
      .contributor-email {
        color: #666;
        font-size: 0.9em;
        margin-top: 2px;
      }
      .leaderboard-commits {
        text-align: center;
        font-weight: bold;
        color: #4caf50;
      }
      .pr-section {
        margin: 30px 0;
      }
      .pr-stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }
      .pr-stat-card {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
      }
      .pr-stat-number {
        font-size: 1.5em;
        font-weight: bold;
      }
      .pr-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      .pr-table th,
      .pr-table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      .pr-table th {
        background-color: #f8f9fa;
        font-weight: bold;
      }
      .pr-table tbody tr:hover {
        background-color: #f5f5f5;
      }
      .pr-status {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.8em;
        color: white;
        font-weight: bold;
      }
      .pr-title {
        max-width: 300px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .pr-number {
        font-weight: bold;
        color: #666;
      }
      .reviewer-leaderboard {
        margin-top: 20px;
      }
      .review-stats {
        text-align: center;
        font-weight: bold;
        color: #059669;
      }
      /* Branch grouping styles */
      .branch-section {
        margin: 30px 0;
      }
      .branch-group {
        margin-bottom: 30px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        overflow: hidden;
      }
      .branch-header {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        padding: 15px 20px;
        margin: 0;
      }
      .branch-header h3 {
        margin: 0;
        font-size: 1.1em;
        display: flex;
        align-items: center;
      }
      .branch-count {
        margin-left: auto;
        font-size: 0.9em;
        opacity: 0.9;
        font-weight: normal;
      }
      .branch-commits {
        padding: 0;
      }
      .branch-commits .commit {
        margin: 0;
        border: none;
        border-bottom: 1px solid #f0f0f0;
        border-radius: 0;
        background-color: #fafafa;
      }
      .branch-commits .commit:last-child {
        border-bottom: none;
      }
      .branch-commits .commit:hover {
        background-color: #f5f5f5;
      }
      /* AI Summary section styles */
      .ai-summary-section {
        margin: 30px 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .ai-summary-section h2 {
        margin: 0 0 15px 0;
        color: white;
      }
      .ai-summary-content {
        background: rgba(255, 255, 255, 0.95);
        padding: 1.5rem;
        border-radius: 8px;
        border-left: 4px solid #4caf50;
        line-height: 1.6;
        font-size: 1.05em;
        color: #333;
      }

      .ai-summary-content p {
        color: #333;
        margin: 0.5rem 0;
      }

      .ai-summary-content strong {
        color: #000;
      }

      /* Branch Trends Section */
      .branch-trends-section {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 2rem;
        border-radius: 12px;
        margin: 2rem 0;
        border-left: 4px solid #4caf50;
      }

      .branch-trends-section h2 {
        color: #333;
        margin-bottom: 1rem;
      }

      .section-description {
        color: #666;
        font-style: italic;
        margin-bottom: 1.5rem;
      }

      .chart-container {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin: 1.5rem 0;
        position: relative;
        height: 400px;
      }

      .trends-summary {
        background: rgba(255, 255, 255, 0.8);
        padding: 1rem;
        border-radius: 6px;
        margin-top: 1rem;
        font-style: italic;
        color: #666;
      }

      .trends-summary strong {
        color: #333;
      }

      /* Weekly Comparison Section */
      .weekly-comparison-section {
        background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
        padding: 2rem;
        border-radius: 12px;
        margin: 2rem 0;
        border-left: 4px solid #e17055;
      }

      .weekly-comparison-section h2 {
        color: #333;
        margin-bottom: 1rem;
      }

      .comparison-metrics {
        display: flex;
        gap: 2rem;
        margin: 2rem 0;
        flex-wrap: wrap;
      }

      .metric-card {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        flex: 1;
        min-width: 200px;
        text-align: center;
      }

      .metric-card h3 {
        margin: 0 0 1rem 0;
        color: #333;
        font-size: 1.1rem;
      }

      .metric-values {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 1rem;
      }

      .current-value {
        font-size: 2rem;
        font-weight: bold;
        color: #27ae60;
      }

      .vs-text {
        color: #666;
        font-style: italic;
      }

      .previous-value {
        font-size: 2rem;
        font-weight: bold;
        color: #95a5a6;
      }

      .metric-change {
        font-size: 1.1rem;
        font-weight: bold;
      }

      .metric-change.up {
        color: #27ae60;
      }

      .metric-change.down {
        color: #e74c3c;
      }

      .metric-change.same {
        color: #95a5a6;
      }

      .weekly-comparison-section .chart-container {
        height: 300px;
      }

      .category-comparison {
        background: rgba(255, 255, 255, 0.8);
        padding: 1.5rem;
        border-radius: 8px;
        margin: 1.5rem 0;
      }

      .category-comparison h3 {
        margin: 0 0 1rem 0;
        color: #333;
      }

      .category-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }

      .category-item {
        background: white;
        padding: 1rem;
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .category-name {
        font-weight: bold;
        color: #333;
      }

      .category-values {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
      }

      .category-values .current {
        color: #27ae60;
        font-weight: bold;
      }

      .category-values .vs {
        color: #666;
        font-style: italic;
      }

      .category-values .previous {
        color: #95a5a6;
        font-weight: bold;
      }

      .trend-icon {
        font-size: 1.2rem;
        margin-left: 0.5rem;
      }

      .trend-icon.up {
        color: #27ae60;
      }

      .trend-icon.down {
        color: #e74c3c;
      }

      .trend-icon.same {
        color: #95a5a6;
      }

      .insights-section {
        background: rgba(255, 255, 255, 0.9);
        padding: 1.5rem;
        border-radius: 8px;
        margin-top: 1.5rem;
        border-left: 4px solid #e17055;
      }

      .insights-section p {
        margin: 0;
        color: #333;
        font-style: italic;
      }

      .insights-section strong {
        color: #e17055;
      }
      .report-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem;
        border-radius: 12px;
        margin-bottom: 2rem;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .main-title {
        font-size: 2.5rem;
        font-weight: bold;
        margin: 0 0 1rem 0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .report-period {
        font-size: 1.2rem;
        margin: 0.5rem 0;
        opacity: 0.9;
      }

      .generation-time {
        font-size: 1rem;
        margin: 0.5rem 0 0 0;
        opacity: 0.8;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <div class='container'>
      <div class='header'>
        <header class='report-header'>
          <h1 class='main-title'>
            {{#if isWeekly}}
              üìä Weekly Git Commit Report
            {{else}}
              üìà Daily Git Commit Report
            {{/if}}
          </h1>
          <p class='report-period'>
            üìÖ Report Period:
            {{formatDate dateRange.start}}
            to
            {{formatDate dateRange.end}}
          </p>
          <p class='generation-time'>
            üïí Generated:
            {{formatDateTime (getCurrentDate)}}
          </p>
        </header>
        <p style='color: #666;'>Period:
          {{dateRange.start}}
          to
          {{dateRange.end}}</p>
      </div>

      <div class='stats-grid'>
        <div class='stat-card'>
          <div class='stat-number'>{{totalCommits}}</div>
          <div>Total Commits</div>
        </div>
        <div class='stat-card'>
          <div class='stat-number'>{{categories.length}}</div>
          <div>Categories</div>
        </div>
        {{#if branchGroups}}
          <div class='stat-card'>
            <div class='stat-number'>{{branchGroups.length}}</div>
            <div>Active Branches</div>
          </div>
        {{/if}}
      </div>

      {{#if categories}}
        <div class='chart-section'>
          <h2>Commit Categories Breakdown</h2>
          <div class='chart-container'>
            <canvas id='categoryChart'></canvas>
          </div>

          <table class='categories-table'>
            <thead>
              <tr>
                <th>Category</th>
                <th>Count</th>
                <th>Percentage</th>
              </tr>
            </thead>
            <tbody>
              {{#each categories}}
                <tr>
                  <td>
                    <span class='category-color' style='background-color: {{color}};'></span>
                    {{name}}
                  </td>
                  <td>{{count}}</td>
                  <td>{{percentage}}%</td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      {{/if}}

      {{#if leaderboard}}
        <div class='leaderboard-section'>
          <h2>Top Contributors Leaderboard</h2>
          <table class='leaderboard-table'>
            <thead>
              <tr>
                <th class='leaderboard-rank'>Rank</th>
                <th class='leaderboard-contributor'>Contributor</th>
                <th class='leaderboard-commits'>Commits</th>
              </tr>
            </thead>
            <tbody>
              {{#each leaderboard}}
                <tr>
                  <td class='leaderboard-rank'>
                    {{#if badge}}<span class='leaderboard-badge'>{{badge}}</span>{{/if}}{{rank}}
                  </td>
                  <td class='leaderboard-contributor'>
                    <div>{{author_name}}</div>
                    <div class='contributor-email'>{{author_email}}</div>
                  </td>
                  <td class='leaderboard-commits'>{{commits}}</td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      {{/if}}

      {{#if prSummary}}
        <div class='pr-section'>
          <h2>Weekly PR & Code Review Summary</h2>

          <div class='pr-stats-grid'>
            <div class='pr-stat-card'>
              <div class='pr-stat-number'>{{prSummary.total_created}}</div>
              <div>PRs Created</div>
            </div>
            <div class='pr-stat-card'>
              <div class='pr-stat-number'>{{prSummary.total_merged}}</div>
              <div>PRs Merged</div>
            </div>
            <div class='pr-stat-card'>
              <div class='pr-stat-number'>{{prSummary.total_reviewed}}</div>
              <div>Reviews Given</div>
            </div>
          </div>

          {{#if prSummary.prs_created.length}}
            <h3>Pull Requests Created</h3>
            <table class='pr-table'>
              <thead>
                <tr>
                  <th>PR</th>
                  <th>Title</th>
                  <th>Author</th>
                  <th>Status</th>
                  <th>Created</th>
                </tr>
              </thead>
              <tbody>
                {{#each prSummary.prs_created}}
                  <tr>
                    <td class='pr-number'>#{{number}}</td>
                    <td class='pr-title'>
                      <a href='{{url}}' target='_blank'>{{title}}</a>
                    </td>
                    <td>{{author}}</td>
                    <td>
                      <span class='pr-status' style='background-color: {{getPRStateColor this}};'>
                        {{getPRStatus this}}
                      </span>
                    </td>
                    <td>{{formatDate created_at}}</td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
          {{/if}}

          {{#if prSummary.prs_merged.length}}
            <h3>Pull Requests Merged</h3>
            <table class='pr-table'>
              <thead>
                <tr>
                  <th>PR</th>
                  <th>Title</th>
                  <th>Author</th>
                  <th>Merged By</th>
                  <th>Merged</th>
                </tr>
              </thead>
              <tbody>
                {{#each prSummary.prs_merged}}
                  <tr>
                    <td class='pr-number'>#{{number}}</td>
                    <td class='pr-title'>
                      <a href='{{url}}' target='_blank'>{{title}}</a>
                    </td>
                    <td>{{author}}</td>
                    <td>{{merged_by}}</td>
                    <td>{{formatDate merged_at}}</td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
          {{/if}}

          {{#if prSummary.reviewer_leaderboard.length}}
            <div class='reviewer-leaderboard'>
              <h3>Top Code Reviewers</h3>
              <table class='leaderboard-table'>
                <thead>
                  <tr>
                    <th class='leaderboard-rank'>Rank</th>
                    <th class='leaderboard-contributor'>Reviewer</th>
                    <th class='review-stats'>Reviews</th>
                  </tr>
                </thead>
                <tbody>
                  {{#each prSummary.reviewer_leaderboard}}
                    <tr>
                      <td class='leaderboard-rank'>
                        {{#if badge}}<span class='leaderboard-badge'>{{badge}}</span>{{/if}}{{rank}}
                      </td>
                      <td class='leaderboard-contributor'>{{reviewer}}</td>
                      <td class='review-stats'>{{reviews}}</td>
                    </tr>
                  {{/each}}
                </tbody>
              </table>
            </div>
          {{/if}}
        </div>
      {{/if}}

      {{#if branchTrends}}
        <!-- Branch Trends Visualization -->
        <div class='branch-trends-section'>
          <h2>üìà Branch Activity Trends</h2>
          <p class='section-description'>
            Commit activity over time by branch. Contributors per branch also tracked.
          </p>

          <div class='chart-container'>
            <canvas id='branchTrendsChart' width='800' height='400'></canvas>
          </div>

          <div class='trends-summary'>
            <p><strong>üìä Analysis:</strong>
              This visualization shows commit patterns across branches over the reporting period.</p>
          </div>
        </div>
      {{/if}}

      {{#if weeklyComparison}}
        <div class='weekly-comparison-section'>
          <h2>üìä This Week vs Last Week</h2>
          <p class='section-description'>
            Compare current week's activity with the previous week to track progress and trends.
          </p>

          <div class='comparison-metrics'>
            <div class='metric-card'>
              <h3>üíª Commits</h3>
              <div class='metric-values'>
                <span class='current-value'>{{weeklyComparison.commits.thisWeek}}</span>
                <span class='vs-text'>vs</span>
                <span class='previous-value'>{{weeklyComparison.commits.lastWeek}}</span>
              </div>
              <div class='metric-change {{weeklyComparison.commits.trend}}'>
                {{#if (eq weeklyComparison.commits.trend 'up')}}‚Üó{{/if}}
                {{#if (eq weeklyComparison.commits.trend 'down')}}‚Üò{{/if}}
                {{#if (eq weeklyComparison.commits.trend 'same')}}‚Üí{{/if}}
                {{#if (gt weeklyComparison.commits.change 0)}}+{{/if}}{{weeklyComparison.commits.change}}
                ({{#if (gt weeklyComparison.commits.percentageChange 0)}}+{{/if}}{{weeklyComparison.commits.percentageChange}}%)
              </div>
            </div>

            <div class='metric-card'>
              <h3>üë• Contributors</h3>
              <div class='metric-values'>
                <span class='current-value'>{{weeklyComparison.contributors.thisWeek}}</span>
                <span class='vs-text'>vs</span>
                <span class='previous-value'>{{weeklyComparison.contributors.lastWeek}}</span>
              </div>
              <div class='metric-change {{weeklyComparison.contributors.trend}}'>
                {{#if (eq weeklyComparison.contributors.trend 'up')}}‚Üó{{/if}}
                {{#if (eq weeklyComparison.contributors.trend 'down')}}‚Üò{{/if}}
                {{#if (eq weeklyComparison.contributors.trend 'same')}}‚Üí{{/if}}
                {{#if (gt weeklyComparison.contributors.change 0)}}+{{/if}}{{weeklyComparison.contributors.change}}
              </div>
            </div>
          </div>

          <div class='chart-container'>
            <canvas id='weeklyComparisonChart' width='600' height='300'></canvas>
          </div>

          {{#if weeklyComparison.categories}}
          <div class='category-comparison'>
            <h3>üìÇ Category Breakdown</h3>
            <div class='category-grid'>
              {{#each weeklyComparison.categories}}
                <div class='category-item'>
                  <span class='category-name'>{{name}}</span>
                  <div class='category-values'>
                    <span class='current'>{{thisWeek}}</span>
                    <span class='vs'>vs</span>
                    <span class='previous'>{{lastWeek}}</span>
                    <span class='trend-icon {{trend}}'>
                      {{#if (eq trend 'up')}}‚Üó{{/if}}
                      {{#if (eq trend 'down')}}‚Üò{{/if}}
                      {{#if (eq trend 'same')}}‚Üí{{/if}}
                    </span>
                  </div>
                </div>
              {{/each}}
            </div>
          </div>
          {{/if}}

          <div class='insights-section'>
            <p><strong>üîç Key Insights:</strong> {{weeklyComparison.insights}}</p>
          </div>
        </div>
      {{/if}}

      {{#if aiSummary}}
        <div class='ai-summary-section'>
          <h2>üìù Weekly AI Summary</h2>
          <div class='ai-summary-content'>
            {{{aiSummary}}}
          </div>
        </div>
      {{/if}}

      {{#if branchGroups}}
        <div class='branch-section'>
          <h2>Commits by Branch</h2>
          {{#each branchGroups}}
            <div class='branch-group'>
              <div class='branch-header'>
                <h3>üåø Branch:
                  {{branch}}
                  <span class='branch-count'>({{count}} commits)</span></h3>
              </div>
              <div class='branch-commits'>
                {{#each commits}}
                  <div class='commit'>
                    <div class='commit-message'>
                      {{message}}
                      {{#if category}}
                        <span
                          class='category-badge'
                          style='background-color: {{getCategoryColor category}};'
                        >{{category}}</span>
                      {{/if}}
                    </div>
                    <div class='commit-meta'>
                      <strong>Author:</strong>
                      {{author_name}}
                      ({{author_email}}) |
                      <strong>Date:</strong>
                      {{date}}
                      |
                      <strong>Hash:</strong>
                      {{hash}}
                    </div>
                  </div>
                {{/each}}
              </div>
            </div>
          {{/each}}
        </div>
      {{else}}
        <h2>Recent Commits</h2>
        {{#each commits}}
          <div class='commit'>
            <div class='commit-message'>
              {{message}}
              {{#if category}}
                <span
                  class='category-badge'
                  style='background-color: {{getCategoryColor category}};'
                >{{category}}</span>
              {{/if}}
            </div>
            <div class='commit-meta'>
              <strong>Author:</strong>
              {{author_name}}
              ({{author_email}}) |
              <strong>Date:</strong>
              {{date}}
              |
              <strong>Hash:</strong>
              {{hash}}
            </div>
          </div>
        {{/each}}
      {{/if}}

      {{#if branches}}
        <div class='branch-section'>
          <h2>Branch-wise Commit Report</h2>
          {{#each branches}}
            <div class='branch-group'>
              <div class='branch-header'>
                <h3>
                  {{name}}
                  <span class='branch-count'>Commits: {{commit_count}}</span>
                </h3>
              </div>
              <div class='branch-commits'>
                {{#each commits}}
                  <div class='commit'>
                    <div class='commit-message'>
                      {{message}}
                      {{#if category}}
                        <span
                          class='category-badge'
                          style='background-color: {{getCategoryColor category}};'
                        >{{category}}</span>
                      {{/if}}
                    </div>
                    <div class='commit-meta'>
                      <strong>Author:</strong>
                      {{author_name}}
                      ({{author_email}}) |
                      <strong>Date:</strong>
                      {{date}}
                      |
                      <strong>Hash:</strong>
                      {{hash}}
                    </div>
                  </div>
                {{/each}}
              </div>
            </div>
          {{/each}}
        </div>
      {{/if}}
    </div>

    {{#if categories}}
      <script>
        const ctx = document.getElementById('categoryChart').getContext('2d'); const chartData =
        {{{chartData}}}; new Chart(ctx, { type: 'doughnut', data: chartData, options: { responsive:
        true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: {
        padding: 20, usePointStyle: true } }, tooltip: { callbacks: { label: function(context) {
        const label = context.label || ''; const value = context.parsed; const total =
        context.dataset.data.reduce((a, b) => a + b, 0); const percentage = ((value / total) *
        100).toFixed(1); return `${label}: ${value} commits (${percentage}%)`; } } } }, cutout:
        '40%' } });
      </script>
    {{/if}}

    {{#if branchTrends}}
      <script>
        const branchTrendsCtx = document.getElementById('branchTrendsChart'); if (branchTrendsCtx) {
        new Chart(branchTrendsCtx, { type: 'line', data:
        {{{json branchTrends}}}, options: { responsive: true, maintainAspectRatio: false, plugins: {
        title: { display: true, text: 'Branch Commit Trends Over Time', font: { size: 16 } },
        legend: { display: true, position: 'top' } }, scales: { y: { beginAtZero: true, title: {
        display: true, text: 'Number of Commits' }, ticks: { stepSize: 1 } }, x: { title: { display:
        true, text: 'Date' } } }, interaction: { intersect: false, mode: 'index' }, elements: {
        line: { tension: 0.3 } } } }); }
      </script>
    {{/if}}

    {{#if weeklyComparison}}
      <script>
        const weeklyComparisonCtx = document.getElementById('weeklyComparisonChart');
        if (weeklyComparisonCtx) {
          const comparisonData = {
            labels: ['Commits', 'Contributors'],
            datasets: [
              {
                label: 'This Week',
                data: [{{weeklyComparison.commits.thisWeek}}, {{weeklyComparison.contributors.thisWeek}}],
                backgroundColor: '#4ade80',
                borderColor: '#22c55e',
                borderWidth: 2
              },
              {
                label: 'Last Week', 
                data: [{{weeklyComparison.commits.lastWeek}}, {{weeklyComparison.contributors.lastWeek}}],
                backgroundColor: '#94a3b8',
                borderColor: '#64748b',
                borderWidth: 2
              }
            ]
          };

          new Chart(weeklyComparisonCtx, {
            type: 'bar',
            data: comparisonData,
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                title: {
                  display: true,
                  text: 'This Week vs Last Week Comparison',
                  font: { size: 16 }
                },
                legend: {
                  display: true,
                  position: 'top'
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  title: {
                    display: true,
                    text: 'Count'
                  },
                  ticks: {
                    stepSize: 1
                  }
                },
                x: {
                  title: {
                    display: true,
                    text: 'Metrics'
                  }
                }
              },
              interaction: {
                intersect: false,
                mode: 'index'
              }
            }
          });
        }
      </script>
    {{/if}}
  </body>
</html>